<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title></title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:brainbuz@qianna.(none)" />
</head>

<body>



<ul id="index">
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#PROJECT-STATUS-IS-BETA">PROJECT STATUS IS BETA</a></li>
  <li><a href="#USAGE">USAGE</a></li>
  <li><a href="#METHODS">METHODS</a>
    <ul>
      <li><a href="#new">new</a></li>
      <li><a href="#generate">generate</a></li>
      <li><a href="#hidden">hidden</a></li>
      <li><a href="#clone">clone</a>
        <ul>
          <li><a href="#Arguments-to-clone">Arguments to clone</a>
            <ul>
              <li><a href="#neworder-newhidden">neworder, newhidden</a></li>
              <li><a href="#input_class-label_class">input_class, label_class</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li><a href="#datavalues">datavalues</a></li>
    </ul>
  </li>
  <li><a href="#The-Form::Diva-Data-Structure">The Form::Diva Data Structure</a>
    <ul>
      <li><a href="#label_class-input_class">label_class, input_class</a></li>
      <li><a href="#form">form</a></li>
      <li><a href="#extra-attribute">extra attribute</a>
        <ul>
          <li><a href="#Common-Attributes-with-no-Value">Common Attributes with no Value</a></li>
        </ul>
      </li>
      <li><a href="#hidden-fields">hidden fields</a></li>
      <li><a href="#TextArea">TextArea</a></li>
      <li><a href="#Select-Radio-Button-and-CheckBox">Select Radio Button and CheckBox</a>
        <ul>
          <li><a href="#values">values</a></li>
          <li><a href="#Over-Riding-Values">Over-Riding Values</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#Miscellaneous">Miscellaneous</a>
    <ul>
      <li><a href="#id-Tags">id Tags</a></li>
      <li><a href="#Errors">Errors</a></li>
    </ul>
  </li>
  <li><a href="#FAQ">FAQ</a>
    <ul>
      <li><a href="#Why-Doesnt-Form::Diva-generate-an-entire-form">Why Doesn&#39;t Form::Diva generate an entire form?</a></li>
      <li><a href="#Where-do-I-use-Form::Diva-in-my-Model-View-or-Controller">Where do I use Form::Diva? in my Model, View or Controller?</a></li>
    </ul>
  </li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
  <li><a href="#AUTHOR">AUTHOR</a></li>
  <li><a href="#BUGS">BUGS</a></li>
  <li><a href="#SUPPORT">SUPPORT</a></li>
  <li><a href="#LICENSE-AND-COPYRIGHT">LICENSE AND COPYRIGHT</a></li>
</ul>

<p># =head1 NAME</p>

<p># Form::Diva - Generate HTML5 form label and input fields</p>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>Generate Form Label and Input Tags from a simple data structure. Simplify form code in your views without replacing it without a lot of even uglier Perl Code in your Controller.</p>

<h1 id="PROJECT-STATUS-IS-BETA">PROJECT STATUS IS BETA</h1>

<p>Most of Form::Diva is unlikely to change, but hasn&#39;t been road-tested enough to know for sure. While you are encouraged to start using Form::Diva, please be aware that there is a small possibility of changes that break compatibility.</p>

<h1 id="USAGE">USAGE</h1>

<pre><code> use Form::Diva;

 my $diva = Form::Diva-&gt;new(
    label_class =&gt; &#39;col-sm-3 control-label&#39;,
    input_class =&gt; &#39;form-control&#39;,
    form        =&gt; [
        { n =&gt; &#39;name&#39;, t =&gt; &#39;text&#39;, p =&gt; &#39;Your Name&#39;, l =&gt; &#39;Full Name&#39; },
        { name =&gt; &#39;phone&#39;, type =&gt; &#39;tel&#39;, extra =&gt; &#39;required&#39; },
        { qw / n email t email l Email c form-email placeholder doormat/},
        { name =&gt; &#39;myradio&#39;, type =&gt; &#39;radio&#39;, default =&gt; 1,
           values =&gt; [ &quot;1:Yes&quot;, &quot;2:No&quot;, &quot;3:Maybe&quot; ] },   
    ],
 );

 my $fields = $diva-&gt;generate;
 my $filledfields = $diva-&gt;generate( $hashref_of_data );</code></pre>

<p>Once you send this to your stash or directly to the templating system the form might look like:</p>

<pre><code>  &lt;form class=&quot;form-horizontal well col-md-8&quot; role=&quot;form&quot;
   method=&quot;post&quot; action=&quot;/form1&quot; name=&quot;DIVA1&quot; &gt;  

  &lt;div class=&quot;form-group&quot;&gt;
In Template Toolkit:
  [% FOREACH field IN fields %] {
    [% field.label %]
    &lt;div class=&quot;col-sm-8&quot;&gt;
        [% field.input %]
    &lt;/div&gt;
  [% END %]
Or in Mojo::Template
  % foreach my $field (@$fields) {
    &lt;%== $field-&gt;{&#39;label&#39;} %&gt;
    &lt;div class=&quot;col-sm-8&quot;&gt;
        &lt;%== $field-&gt;{&#39;input&#39;} %&gt;
    &lt;/div&gt;
 % }

 &lt;/div&gt;

 &lt;div class=&quot;form-group&quot;&gt;
    &lt;div class=&quot;col-sm-offset-3 col-sm-8&quot;&gt;
      &lt;input type=&quot;submit&quot; class=&quot;btn btn-large btn-primary&quot; 
      name=&quot;submit&quot; value=&quot;submit_me&quot; &gt;&amp;nbsp;
    &lt;/div&gt;
 &lt;/div&gt;
 &lt;/form&gt;</code></pre>

<h1 id="METHODS">METHODS</h1>

<h2 id="new">new</h2>

<p>Create a new object from a Data Structure ().</p>

<h2 id="generate">generate</h2>

<p>When called without arguments returns the blank form with placeholders and value set to default or null if there is no default.</p>

<p>When provided an optional hashref of data it sets values based on the hashref and suppresses placeholder.</p>

<p>A second optional hashref may be passed to override the values list for select, checkbox and radio button inputs, see below.</p>

<p>The data returned is in the form of an array reference where each element of the array is two hashreferences: label and input.</p>

<h2 id="hidden">hidden</h2>

<p>Generate the hidden fields in the data structure. The generated hidden tags are returned as a singular block of text since no formatting is applicable and they just need to be included somewhere in the form.</p>

<pre><code>  $c-&gt;stash( hidden =&gt; $diva-&gt;hidden( $data_hashref ) );</code></pre>

<h2 id="clone">clone</h2>

<p>Copy a Form::Diva object optionally modifying some of the values in the copy. This is useful if you have several similar forms, define a form diva object with all of the fields, then make copies for the shorter forms.</p>

<pre><code> my $newdiva = $diva-&gt;clone({ 
    neworder =&gt; [ qw / A B c D E /], 
    newhidden   =&gt; [ &#39;X&#39; , &#39;Zebra&#39;] });</code></pre>

<h3 id="Arguments-to-clone">Arguments to clone</h3>

<p>Arguments to clone are passed as a hashref. All of the arguments are optional since if omitted the original object is just copied. clone with no arguments would just make a copy of your original object. The arguments are:</p>

<h4 id="neworder-newhidden">neworder, newhidden</h4>

<p>Array refs of the names of fields in your form. This will let you re-order fields and you do not need to include all of the fields. You cannot define new fields on a clone but you can omit them. You can change fields between hidden and visible, fields originally defined as hidden become text fields, unless you defined a type for them.</p>

<h4 id="input_class-label_class">input_class, label_class</h4>

<p>Change these values for your copy.</p>

<h2 id="datavalues">datavalues</h2>

<p>Returns the data that would be used by generate as an array_ref of hashrefs for: name, type, label, and value. This applies only to visible fields, if you want hidden fields you&#39;ll need to clone the object and make them visible.</p>

<p>There are two optional parameters: &#39;moredata&#39; and &#39;skipempty&#39;.</p>

<p>skipempty suppresses returning fields with no data. Without data skipempty returns an empty array_ref, this might become an exception in the future.</p>

<p>moredata returns all internal data defined for each row including placeholder and default which are meaningless when there is data. When these parameters are used without data it is necessary to pass undef in place of data.</p>

<pre><code>  my $datavalues = $diva-&gt;datavalues( undef, &#39;moredata&#39;);
  say $datavalues-&gt;[2]{name};

  my $dv = $diva-&gt;datavalues( { user =&gt; &#39;me&#39;, password = &#39;secret&#39; } );
  foreach my $row ( @{$dv} ) { say &quot;$row-&gt;{name} = $row-&gt;{value}&quot; }
    output : user = me
             password = secret</code></pre>

<h1 id="The-Form::Diva-Data-Structure">The Form::Diva Data Structure</h1>

<pre><code> { label_class =&gt; &#39;some class in your css&#39;,
   input_class =&gt; &#39;some class in your css&#39;,
   form        =&gt; [
        { name =&gt; &#39;some_field_name&#39;, ... },
        ...
   ],
   hidden       =&gt; [ 
        { name =&gt; &#39;some_hidden_field_name&#39;, ... },
        ...
   ],
 }</code></pre>

<h2 id="label_class-input_class">label_class, input_class</h2>

<p>Specify the contents the label&#39;s class attribute and the input&#39;s class attribute. The input_class can be over-ridden for a single field by using the c/class attribute in a field definition.</p>

<p>If you need to access these two values in code they both have accessor methods $diva-&gt;label_class() and $diva&gt;input_class();.</p>

<h2 id="form">form</h2>

<p>Form::Diva knows about the most frequently needed attributes in HTML5 label and input tags. The attribute extra is provided to handle valueless attributes like required and attributes that are not explicitly supported by Form::Diva. Each supported tag has a single character shortcut. When no values in a field definition require spaces the shortcuts make it extremely compact to describe a field using qw/.</p>

<p>The only required value in a field definition is name. When not specified type defaults to text.</p>

<p>Multivalued fields (checkboxes, select) are not currently supported, but may be in the future.</p>

<p>Supported attributes and their shortcuts</p>

<pre><code> c       class        over-ride input_class for this field
 d       default      sets value for an empty form
 e,x     extra        any other attribute(s)
 i       id           defaults to formdiva_$field{name}
 l       label        defaults to ucfirst(name)
 n       name         field name -- required
 p       placeholder  placeholder to show in an empty form
 t       type         checkbox, radio, textarea or any input types
                      type defaults to text input type
 v       values       for radio and checkbox inputs only</code></pre>

<h2 id="extra-attribute">extra attribute</h2>

<p>The contents of extra are placed verbatim in the input tag. Use for HTML5 attributes that have no value such as disabled and any of the other attributes you may wish to use in your forms that have not been implemented, you will need to type out attribute=&quot;something&quot; if it is not valueluess.</p>

<h3 id="Common-Attributes-with-no-Value">Common Attributes with no Value</h3>

<p><b>disabled</b>, <b>readonly</b>, <b>required</b></p>

<p>Should be placed in the extra field when needed.</p>

<h2 id="hidden-fields">hidden fields</h2>

<p>Hidden fields are specified with a seperate hash reference in the data structure. They use a subset of the same options as normal fields. The relevant options are name (which is mandatory), id, extra, and default. If you define type for a hidden field and then later in a clone make it visible it will be that type, otherwise it would be text.</p>

<h2 id="TextArea">TextArea</h2>

<p>TextArea fields are treated by the Form::Diva structure as a regular input type, but &lt;TextArea... is what gets generated.</p>

<h2 id="Select-Radio-Button-and-CheckBox">Select Radio Button and CheckBox</h2>

<p>Select, Radio Button and CheckBox Input types are similar to each other, and take an extra attribute &#39;values&#39;. Form::Diva does not currently support multi-valued.</p>

<h3 id="values">values</h3>

<p>For CheckBoxes the values attribute is just the values of the check boxes. If value is set and matches one of the values it will be checked.</p>

<pre><code>  { type =&gt; &#39;checkbox&#39;,
    name =&gt; &#39;mycheckbox&#39;,
    values =&gt; [ &#39;Miami&#39;, &#39;Chicago&#39;, &#39;London&#39;, &#39;Paris&#39; ] }</code></pre>

<p>For RadioButtons the values attribute is a number and text seperated by a colon. When the form is submitted just the number will be returned.</p>

<pre><code>  { t =&gt; &#39;radio&#39;,
    n =&gt; &#39;myradio&#39;,
    v =&gt; [ &#39;1:New York&#39;, &#39;2:Philadelphia&#39;, &#39;3:Boston&#39; ] }</code></pre>

<p>For Select inputs there are two forms of values. If the value itself and the label are the same then values is just a list of those values which will also be used as the label. The second form requires the value and the label to be seperated by a colon.</p>

<pre><code>  values =&gt; [ qw /pineapple persimmon nectarine ]
  or 
  values =&gt; [ &#39;item1:Pineapple&#39;, &#39;item2:Georgia Peach&#39;, &#39;item3:Naval Orange&#39;]</code></pre>

<p>When using the first form of values the label is not CamelCased or otherwise changed, if you want that you&#39;ll need to use the second form.</p>

<h3 id="Over-Riding-Values">Over-Riding Values</h3>

<p>It is possible to override values by passing an extra argument to generate. The override argument is a hashref <code>{ field_name =&gt; [ values ...] } </code>. It is even possible to create your initial object with an empty values lists and pass a list every time you generate the form.</p>

<h1 id="Miscellaneous">Miscellaneous</h1>

<h2 id="id-Tags">id Tags</h2>

<p>Form::Diva strives to put an id tag everywhere it can. When you define a field you can specify an id, if you don&#39;t Form::Diva generates one by prepending &#39;formdiva_&#39; to the value for name.</p>

<p>For the elements of CheckBox, Radio or Select the id tag is generated as $field_id_$option_name. To insure uniqueness it is lowercased, and in the case of a duplicate a number is appended. This insures that the generated ids are unique but predictable.</p>

<h2 id="Errors">Errors</h2>

<p>Form::Diva doesn&#39;t do a huge amount of Error Checking or validation, but it does check that you don&#39;t use a field more than once on both <code>new</code> and <code>clone</code> methods.</p>

<h1 id="FAQ">FAQ</h1>

<h2 id="Why-Doesnt-Form::Diva-generate-an-entire-form">Why Doesn&#39;t Form::Diva generate an entire form?</h2>

<p>Form::Diva is intented to be used with Templating systems, the HTML generation is best left to the templating system. Telling form diva what you need in the Form Tag and whether you prefer to use a submit input or a button instead and what goes in them is only going to make it more complex, and make your application less readable because you will have replaced HTML with abstract perl code but not saved any space or labor. If you really want to generate your whole form in Perl, there are plenty of other Form Modules on CPAN.</p>

<h2 id="Where-do-I-use-Form::Diva-in-my-Model-View-or-Controller">Where do I use Form::Diva? in my Model, View or Controller?</h2>

<p>Wherever works best for you. Think of it as preparing your data for the View.</p>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<p>Here are a few other Form Modules on CPAN: HTML::Form::Fu, Form::Sensible, Form::Factory, Form::Toolkit</p>

<p>Form::Diva is meant to be used with a Templating System. Template::Toolkit is the default templating system for Catalyst and Dancer. Template::Alloy is a drop in replacement for TemplateToolkit. Mojo::Template is a Perl reimplemenation of ERB and the default for Mojolicious.</p>

<h1 id="AUTHOR">AUTHOR</h1>

<p>John Karr, <code>brainbuz at brainbuz.org</code></p>

<h1 id="BUGS">BUGS</h1>

<p>Please report any bugs or feature requests through the web interface at <a href="https://bitbucket.org/brainbuz/formdiva/issues">https://bitbucket.org/brainbuz/formdiva/issues</a>. I will be notified, and then you&#39;ll automatically be notified of progress on your bug as I make changes.</p>

<h1 id="SUPPORT">SUPPORT</h1>

<p>You can find documentation for this module with the perldoc command.</p>

<pre><code>    perldoc Form::Diva</code></pre>

<p>You can also look for information at:</p>

<h1 id="LICENSE-AND-COPYRIGHT">LICENSE AND COPYRIGHT</h1>

<p>Copyright 2014 John Karr.</p>

<p>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>

<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>

<p>You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.</p>


</body>

</html>


